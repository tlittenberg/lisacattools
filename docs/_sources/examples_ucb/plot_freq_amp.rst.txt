
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "examples_ucb/plot_freq_amp.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download_examples_ucb_plot_freq_amp.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_examples_ucb_plot_freq_amp.py:


Frequency-Amplitude plot
========================

This example will demonstrate how to display a scatter plot of detections.

.. GENERATED FROM PYTHON SOURCE LINES 7-56



.. image:: /examples_ucb/images/sphx_glr_plot_freq_amp_001.png
    :alt: Point estimates for 6195 sources found in catalog aws_6mo_v2
    :class: sphx-glr-single-img





.. code-block:: default


    import numpy as np
    import pandas as pd
    import matplotlib.cm as cm
    import matplotlib.pyplot as plt
    import matplotlib.colors as colors
    import lisacattools.lisacattools as lisacat

    #load catalog
    catFile = 'cat15728640_v2/cat15728640_v2.h5'
    cat = pd.read_hdf(catFile, key='detections')
    meta = pd.read_hdf(catFile, key='metadata')

    #set up matplotlib figure
    fig = plt.figure(figsize=(12, 6), dpi = 100)
    ax = plt.axes()

    plt.yscale('log')
    plt.xscale('log')
    plt.xlabel('Frequency [Hz]',fontsize=14)
    plt.ylabel('Strain Amplitude',fontsize=14)
    plt.title('Point estimates for %i sources found in catalog %s' % (len(cat), meta.index[0]),fontsize=18)

    #color points in scatter plot by SNR
    cNorm = colors.LogNorm(vmin=cat['SNR'].min(), vmax=cat['SNR'].max()) #re-wrapping normalization
    scalarMap = cm.ScalarMappable(norm=cNorm, cmap=plt.cm.get_cmap('cool'))
    cbar = fig.colorbar(scalarMap)
    cbar.set_label('SNR',fontsize=14)


    #the scatter plot
    cat.plot(
        kind='scatter', 
        x='Frequency', 
        y='Amplitude',  
        marker = '.',
        c = scalarMap.to_rgba(np.array(cat['SNR'])),
        ax = ax);

    #add sensitivity curve
    f = np.logspace(-4,0,512)
    ax.plot(f,lisacat.getSciRD(f,np.float(meta.iloc[0]['Observation Time'])), color='k')
    ax.legend(['Instrument Sensitivity','resolved GBs'],fontsize=14)
    ax.grid()

    plt.show()





.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 0 minutes  0.795 seconds)


.. _sphx_glr_download_examples_ucb_plot_freq_amp.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example



  .. container:: sphx-glr-download sphx-glr-download-python

     :download:`Download Python source code: plot_freq_amp.py <plot_freq_amp.py>`



  .. container:: sphx-glr-download sphx-glr-download-jupyter

     :download:`Download Jupyter notebook: plot_freq_amp.ipynb <plot_freq_amp.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
